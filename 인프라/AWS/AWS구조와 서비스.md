# 기초 지식

## 용어
### 서버리스
- 서버리스 : 서비스가 이용될 때만 서버를 가동하는 방식. 서버가 이용된 시간만큼 발생.
- 프로비저닝 : 서버가 계속 실행중. 서버가 동작하고 있다면 그 시간만큼 요금이 발생.
### 개방형 클라우드와 폐쇄형 클라우드
- 개방형 클라우드 : 모든 사람이 쓸 수 있게 공개된 형태 (AWS)
	- Bare Metal 서비스 : 어떤 소프트웨어도 설치되어 있지 않은 상태
	- VPC(Virtual Private Cloud) : 사용자의 점유 공간 제공
- 폐쇄형 클라우드 : 시설 내부에 클라우드 컨테이너를 두고 전용 클라우드 환경을 구축
	- 독점 공간에서 보안을 충분히 확보한다.
	- 초기 투자비용이 크다.
### 서비스 제공 형태에 따른 분류
- SaaS(Software as a service) : 응용 프로그램을 서비스로 제공하는 형태 (Gmail, Dropbox, Office365, Zoom)
- PaaS(Platform as a service) : 응용 프로그램을 만들기 위한 기능을 서비스로 제공하는 형태. 
	- OS 및 미들웨어관리.
	- 관리형 서비스 : RDS, DynamoDB, Lambda
		- 유지보수는 AWS가 담당한다.
- IaaS(Infrastructure as service) : 응용 프로그램을 만들기 위한 기능을 서비스로 제공하는 형태. 
	- 서버 및 네트워크 기능만 제공
	- EC2, VPC, EBS

## AWS를 이해하기 위한 6가지 특징
- AWS와 사용자 간의 책임 공유
	- 공동 책임 모델
	- 하드웨어 문제는 AWS가 책임지고 복구한다.
- 글로벌 시스템 구축 가능
	- 리전 단위로 분리되어있다.
	- 가용 영역(AZ) : 각 리전에 여러개의 가용영역 존재
- 사용한 만큼만 이용료 지불
	- 종량 과금제
	- 서버 사양 X 시간 당 요금으로 계산한다.
- 서버의 자원과 수를 설정에서 쉽게 변경
	- CPU, 메모리량이나 수를 쉽게 변경할 수 있도록 구축된 서비스이다.
- 장애를 예상한 설계
	- 서버를 여러 AZ에 배포해 한 개 이상의 AZ에 장애가 발생하더라도 중단 없는 서비스를 제공한다.
	- 가용성 : 중단 없이 계속해서 실행할 수 있는 능력
- 설계의 모범이 되는 프레임워크
	- Well-Architected 프레임워크
		- 운영 우수성, 보안, 안정성, 성능 효율성, 비용 최적화, 지속 가능성
## 서비스 분류 및 대표적인 서비스
- 서비스 분류
	- 컴퓨팅
		- EC2 : 가상 서버
		- ECS : 컨테이너 서비스		
	- 스토리지
		- S3, EBS
	- 네트워크 및 콘텐츠 전송
		- VPC, Route 5S, ELB
	- 데이터베이스
		- RDS, DynamoDB
	- 보안, 자격 증명
- 관리형, 비관리형
	- 관리형
		- RDS, S3
	- 비관리형
		- EC2
# AWS 사용 시작
- 루트 계정과 IAM 계정 존재
- AWS를 웹 브라우저 말고 CLI로 조작할 수 있다.
	- 언제나 같은 결과를 얻을 수 있어 재현성이 높다.
- 프로그램으로도 조작할 수 있다.
	- AWS SDK를 설치해야한다.
- AWS 비용 관리
	- 종량 과금제
# 컴퓨팅 서비스
## 서버
- 시스템 처리를 실행할 컴퓨터
### 종류
- 웹 서버
	-  HTML, CSS, image 등이 저장해서 데이터를 제공한다.
	- EC2
- 데이터베이스 서버
	- 데이터 보존이나 갱신, 백업 등의 관리 기능, 데이터 검색 등을 실시하는 데이터 처리
	- RDS
- 메일 서버
	- 메일을 보내는 서버
	- SES
### EC2
- 가상 서버 서비스
- 인스턴스 설정
	- AMI : Amazon 머신 이미지. OS와 소프트웨어가 설정된 템플릿
	- 인스턴스 유형 : CPU와 Memory 사양 선택
		- 패밀리, 세대, 추가기능, 크기
			- 패밀리
				- T : 버스트 가능한 범용유형
				- M :  균형 잡힌 범용 유형
				- C : 컴퓨팅 최적화(vCPU 수가 많음)
				- R : 메모리 최적화
				- P : 고속 컴퓨팅
				- I : 스토리지 최적화
	- VPC : 가상머신이 위치할 네트워크
	- EBS :  스토리지 용량
	- 보안그룹 : 접근 권한 설정
- AWS Systems manager로 EC2 인스턴스에 연결할 수 있다.

### 가상 서버를 안전하게 외부에 공개
- 인바운드 규칙, 아웃바운드 규칙으로 허용가능한 IP를 선택한다.
-  규칙에 IP외에도 보안그룹을 넣을 수 도 있다.
## 부하에 따라 서버를 자동으로 추가, 삭제
- Amazon EC2 Auto Scaling
	- 자동으로 CPU 사용량에 따라 스케일 업, 다운을 한다.
	- RDS, ECS에서도 사용할 수 있다.

## 서버 없이 프로그램 실행
### Lambda
- 서버리스 컴퓨팅 서비스
- 코드가 실행될 때만 요금이 부과되므로 비용을 절감할 수 있다.
- 개발자는 코드만 관리하면 된다.
- 고가용성, 장애 대응성이 유지된다.
- EC2의 장점
	- OS 설정등을 그대로 사용할 수 있다.
	- 인스턴스 유형, OS, 네트워크 등을 자유롭게 설정할 수 있는 유연성이 있다.
	- 대량의 트래픽이나 접속을 상시 처리하는 경우 EC2 쪽이 저렴해질 수 있다.
	- 서버에 프로그램을 배포한다는 기존 방식으로 개발을 진행할 수 있다. Lambda는 AWS의 독자적인 설정 방법과 개발 방법이 있으므로 초보자에게는 어려울 수 있다.
### 함수 생성 및 실행
- Lambda 에서는 함수라는 단위로 프로그램 코드를 관리하고 처리한다.
## 서버리스 활용법 이해
-  API Gateway 와 Lambda를 결합해 사용자의 HTTP요청을 Lambda 함수로 처리할 수 있다.
- S3에 데이터를 저장할 때 자동처리
- EventBridge 서비스로 주기적으로 Lambda 함수 실행
- Lambda 함수에 IAM역할 형식으로 권한을 부여해야한다.
	- 기본으로는 CloudWatch 감시 서비스로 로그를 보내는 권한만 부여된다.
- GB-초 : 메모리 1GB의 함수가 1초간 실행된 경우의 요금
	- 요금이 별로 발생하지 않는다.
## 컨테이너
- 컨테이너는 가상화에 비해 가볍고 빠르다.
- 가상서버는 운영체제가 시작된 후 미들웨어, 응용 프로그램이 실행되는 형태이지만, 컨테이너는 응용프로그램을 실행하여 빠르다.
- 빌드, 배포에 드는 시간이 단축되므로 효율적인 개발이 가능하다.
- 동일한 개발 환경으로 시작할 수 있다.

## ECS로 누리는 컨테이너의 장점
- ECS : 관리형 컨테이너 오케스트레이션 서비스
- ECR : 컨테이너 이미지 레지스트리 서비스. 사용자 정의된 컨테이너 이미지를 AWS에서 관리할수 있고 ECS에도 쉽게 배포할 수 있다.
- ECS로 컨테이너를 기동할 때 플랫폼 선택
	- EC2
	- Fargate : AWS에서 관리하는 서버에서 컨테이너 실행
		- 컨테이너 런타임과 OS도 AWS에서 관리한다.

## 쿠버네티스를 보다 쉽게 사용할 수 있는 서비스
- EKS

# 스토리지 서비스
## 객체 스토리지
- S3는 ID로만 데이터를 관리한다.
- 버킷 : 객체를 저장하는 장소, 전 세계에서 고유해야한다.
- 객체 : 버킷에 저장된 데이터 본체. 한 객체의 최대 크기는 5TB
- 키 : 객체의 저장 URL경로다. 버킷 이름과 키 이름, 객체 이름을 조합해 고유해야한다.

### S3의 데이터를 브라우저나 프로그램에서 조작
- S3 API 제공
- 비용과 가용성이 다른 여러 스토리지 클래스를 제공한다.
- 생명주기 설정으로 자동으로 스토리지 클래스 변경도 가능하다.
### S3 버킷에 대한 접근 제어
- IAM 정책 : 사용자에 대한 권한 설정
- ACL(접근 제어 목록) : 객체 또는 버킷 단위로 설정할 수 있는 접근 제어
- 버킷 설정 : 버킷 단위로 설정하는 접근 제어
- https를 지원하지 않아 CloudFront를 사용하여 https 통신을 할 수 있게 구성한다.
### 데이터 암호화
- 데이터와 키 데이터를 조합해 데이터 내용을 타인이 볼 수 없게 한다.
- 버킷의 기본 암호화 기능을 활성화하면 자동으로 암호화를 한다.
## 가상 서버 데이터 저장을 위한 EBS
- EC2와 함께 사용하는 스토리지 서비스
- EC2의 HDD/SSD와 같은 역할을 하며 EC2에서 실행되는 응용 프로그램의 데이터, 로그, 설정 정보등을 저장하는 데 주로 사용한다.
- 스냅숏을 지원하여 백업이 가능하다.
- 사용자 AMI를 생성할 수 있다.
- EC2가 중지되어도 연결된 EBS는 계속 요금이 발생한다.
# 네트워크 및 콘텐츠 전송 서비스
- 프라이빗 IP
	- 10.0.0.0 ~ 10.255.255.255(10.0.0.0/8)
	- 172.16.0.0 ~ 172.31.255.255(172.16.0.0/12)
	- 192.168.0.0 ~ 192.168.255.255(192.168)
- 퍼블릿 IP
	- 나머지 IP 주소
- CIDR
	- 네트워크와 호스트로 나뉜다.
	- /숫자가 상위 비트 수로 네트워크 주소다.
	- 172.31.0.0 -> 네트워크 주소
	- 172.31.255.255 -> 브로드캐스트 주소
- 방화벽
	- 보안 그룹
	- 네트워크 ACL
- 부하 분산
	- 로드밸런서
- 라우팅 및 라우팅 테이블
	- 라우팅 : 최적의 경로를 찾아서 경로를 결정하는 것
	- 라우팅 테이블 : 라우터가 소유한 네트워크 지도.  VPC의 라우팅 테이블
- 인터넷 게이트 웨이 : 서브넷 안에 있는 EC2와 같은 자원이 인터넷과 통신할 수 있게 하기 위한 기능
- 퍼블릭 서브넷 : 인터넷 게이트웨이로 가는 경로가 설정된 서브넷
- 프라이빗 서브넷 : 인터넷 게이트웨이를 통해 인터넷과 통신할 수 없는 서브넷
- Elastic IP : 고정된 IP주소
- NAT 게이트웨이 : 프라이빗 IP 주소를 퍼블릭 IP 주소로 변환
	- 외부 통신을 수행하는 서브넷의 라우팅 테이블에 경로 정보 등록 필요
- VPC 접근 제어 및 통신 로그 확인
	- ACL : 네트워크 접근 제어 목록
		- 서브넷 단위로 설정
		- 허용 및 거부 설정
		- 상태 비저장
		- 단일 패킷만 확인하므로 정보를 저장하지 않음
		- 등록된 규칙의 번호순으로 트래픽 허용 및 거부
	- 보안 그룹
		- 인스턴스 단위로 설정
		- 허용만 설정
		- 상태 저장
		- 패킷과 세션까지 확인하므로 정보를 저장
		- 등록된 모든 규칙을 평가해 트래픽 허용
- ENI :  네트워크 인터페이스
	- EC2, RDS, ELB와 같은 VPC의 자원의 로그가 수집된다.
- 다른 VPC나 다른 AWS 서비스와 연결하는 기능
	- VPC 피어링
		- 2개의 VPC를 연결
		- 각각 따로 피어링 구성
	- Transit GateWay
		- 하나의 중앙 허브에서 관리
	- VPC와 VPC외 AWS 서비스 연결
		- VPC 엔드포인트 사용
		- 게이트 웨이 엔드포인트
			- S3, DynamoDB에서 사용하는 VPC 엔드포인트
			- 퍼블릿 IP 사용
		- 인터페이스 엔드포인트
			- PrivateLink 기능 사용.
			- ENI를 생성해 프라이빗 IP로 통신
- AWS 서비스 유형
	- 글로벌 서비스
		- 특정 리전에 의존하지 않고 실행되는 서비스
		- CloudFront, IAM
	- 리전 서비스
		- 리전 내, VPC 외부에서 실행되는 서비스
		- S3, DynamoDB
	- AZ 서비스
		- VPC내에서 실행되는 서비스
		- EC2, RDS
### 다른 AWS 서비스와 결합된 구성 예
- Web + DB + CloudFront
	- ELB만 public 서브넷에 두고 웹 서버와 DB 서버는 private으로 둔다.
- VPC 엔드포인트를 사용하는 S3 연결
	- RDS로 부터 취득한 데이터를 S3에 저장한다.
### ELB
- Elastic Load Balancing
- 부하 분산
	- 재해 발생시 가용성 향상
	- 대량 접속 부하 분배
- 대상 모니터링
	- 연결 상태 감시
	- 요청 추적 및 CloudWatch 지표 취득
- 보안 기능
	- SSL/TLS 서버 인증서를 설정해 암호화 통신 가능
- 유형
	- ALB : http, https 트래픽 부하 분산 가능(일반적인 웹 사이트에 선택)
	- NLB : http 이외의 프로토콜을 이용하는 경우 선택
- 비용
	- 1시간당 사용료 + 로드 밸런서 커패서티 유닛 이용료
### Route 53
- AWS가 제공하는 DNS서비스
- 도메인 등록 기능
- 도메인 트래픽 라우팅
	- 단순 라우팅 : 하나의 IP주소만 하나의 도메인에 연결
	- 가중치 기반 라우팅 : 라우팅 대상을 여러 개를 트래픽에 할당하는 정도를 0~255 사이의 값으로 지정.
	- 지리적 위치 라우팅 : 위치 정보에 따라 어떤 IP 주소를 반환할지 결정
	- 지연 시간 라우팅 : 레이턴시가 최소인 자원의 IP 주소를 우선 반환
	- 장애 조치 라우팅 : 프라이머리에 장애가 발생하면 보조로 라우팅
	- 다중값 응답 라우팅 : 다중값 응답을 설정하면 무작위로 라우팅
- 자원에 대한 상태 확인
	- 대상이 정상적으로 실행 중인지 확인
### CloudFront
- CDN(콘텐츠 전달 네트워크) : 동영상 파일과 같은 대용량 디지털 콘텐츠를 인터넷에서 효율적으로 사용자에게 전달하기 위한 네트워크
- 원본 서버에서 데이터의 복사본을 전 세계에 존재하는 캐시 서버에 저장한다.
- 장점
	- 대용량 콘텐츠의 빠른 배포
	- 보안 향상
		- 자동으로 SSL/TLS 암호화 수행
		- DDoS 공격 대처
	- 가용성 향상
		- 원본 서버에 대한 부하 분산
- 배포
	- 원본 서버에 배치된 파일에 대한 정보 단위
	- AWS WAF : IP제한이나 취약점 대응 수행 가능
- 원본
	- S3 이나 ELB 등을 대상으로 할 수 있다.
### 다양한 네트워크 기능을 제공하는 서비스 7가지
- VPN : 인터넷을 가상으로 전용선처럼 취급하는 기술
- Direct Connect : 전용성
- Transit GateWay : VPC 간 연결 대상을 한 곳으로 설정한다.
- PrivateLink : VPC 엔드포인트 생성. 내부적으로 다른 VPC와 통신할 수 있다.
- API GateWay : 웹 API 생성 서비스.
- AWS Global Accelerator : AWS가 더 빠르게 접근할 수 있게 하는 서비스
	- 60%  네트워크 지연시간이 향상된다.
- AWG Ground Station : 인공위성과 기지국 통신

## 데이터베이스
### RDS
- 종량 과금제. 인스턴스가 기동되는 시간만큼 요금 발생
- 데이터베이스 엔진 설치 필요 X
- 인스턴스 유형 선택 가능
- 스토리지 유형
	- 범용 SSD
	- 프로비저닝 IOPS SSD
	- 마그네틱 HDD
- 예비 복제본을 다중 AZ 에 배포해 가용성을 높일 수 있다.
	- 장애 조치 가능
- 읽기 전용 레플리카 기능
- 데이터 백업
	- 자동 백업 기능으로 스냅숏 유지
		- 스냅숏은 S3에 보존된다.
	- 특정 시점 복구
### Aurora
- MySQL, PostgreSQL과 동일하게 사용할 수 있다.
- DB 클러스터 단위로 관리
- 클러스터 볼륨 : 데이터 관리
- 쿼럼 모델
	- 복제 관리 구조
	- 쓰기 처리 6개 중 4개 성공시 성공
	- 읽기 처리 6개 중 3개 성공시 성공
- Aurora 복제
	- 1개로 가용성 향상과 읽기 성능 향상
- 스토리지 유형과 용량을 지정할 필요가 없다.
	- 스토리지 관리는 AWS가 수행한다.
- AWS에 최적화 되어있다. 
- 우선 검토하는 것이 좋다.
### DynamoDB

